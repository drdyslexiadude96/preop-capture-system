<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pre-Operative Dental & Airway Capture System</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{font-family:Arial,Helvetica,sans-serif;margin:30px}
h1{font-size:34px}
h2{margin-top:30px}
.section{margin-bottom:25px}
label{display:block;margin:6px 0}
.complete{color:green;font-weight:bold}
.incomplete{color:red;font-weight:bold}
img.preview{max-width:260px;margin-top:10px;border:1px solid #ccc}
button{padding:10px 18px;font-size:16px}
hr{margin:25px 0}
</style>
</head>

<body>

<h1>Pre-Operative Dental & Airway Capture System</h1>
<strong>Patent Pending</strong><br><br>

<label>
Patient / Session ID:
<input type="text" id="sessionId" placeholder="Patient Pending">
</label>

<hr>

<h2>I1 — Airway View <span id="airwayStatus" class="incomplete">Incomplete</span></h2>

<label>
Mallampati Class:
<select id="mallampati">
<option value="">Select</option>
<option>I</option>
<option>II</option>
<option>III</option>
<option>IV</option>
</select>
</label>

<label><input type="checkbox" id="tongue"> Tongue obstruction noted</label>

<strong>Mallampati Rationale (Observed)</strong>
<label><input type="checkbox" class="obs" value="Soft palate visible"> Soft palate visible</label>
<label><input type="checkbox" class="obs" value="Uvula visible"> Uvula visible</label>
<label><input type="checkbox" class="obs" value="Faucial pillars visible"> Faucial pillars visible</label>
<label><input type="checkbox" class="obs" value="Only hard palate visible"> Only hard palate visible</label>

<label>
Airway Image:
<input type="file" id="airwayImage" accept="image/*">
</label>
<img id="airwayPreview" class="preview">

<hr>

<h2>Dentition Images</h2>

<div class="section">
<h3>I2 — Upper Dentition <span class="status incomplete">Incomplete</span></h3>
<input type="file" class="imgInput" accept="image/*">
<img class="preview">
<label><input type="checkbox"> Missing teeth</label>
<label><input type="checkbox"> Crowns / restorations</label>
<label><input type="checkbox"> Chips / fractures</label>
</div>

<div class="section">
<h3>I3 — Lower Dentition <span class="status incomplete">Incomplete</span></h3>
<input type="file" class="imgInput" accept="image/*">
<img class="preview">
<label><input type="checkbox"> Missing teeth</label>
<label><input type="checkbox"> Crowns / restorations</label>
<label><input type="checkbox"> Chips / fractures</label>
</div>

<div class="section">
<h3>I4 — Right Molars <span class="status incomplete">Incomplete</span></h3>
<input type="file" class="imgInput" accept="image/*">
<img class="preview">
<label><input type="checkbox"> Missing teeth</label>
<label><input type="checkbox"> Crowns / restorations</label>
<label><input type="checkbox"> Chips / fractures</label>
</div>

<div class="section">
<h3>I5 — Left Molars <span class="status incomplete">Incomplete</span></h3>
<input type="file" class="imgInput" accept="image/*">
<img class="preview">
<label><input type="checkbox"> Missing teeth</label>
<label><input type="checkbox"> Crowns / restorations</label>
<label><input type="checkbox"> Chips / fractures</label>
</div>

<div class="section">
<h3>I6 — Natural Occlusion <span class="status incomplete">Incomplete</span></h3>
<input type="file" class="imgInput" accept="image/*">
<img class="preview">
<label><input type="checkbox"> Missing teeth</label>
<label><input type="checkbox"> Crowns / restorations</label>
<label><input type="checkbox"> Chips / fractures</label>
</div>

<hr>

<h2>Clinical Interpretation</h2>
<div id="clinicalText">
Airway Risk:<br>
Risk Description:<br>
Interpretation:<br>
Observed Findings:
</div>

<hr>

<h2>Reviewer</h2>
<label>Reviewed by: <input type="text" id="reviewer"></label>

<label>
Role:
<select id="role">
<option value="">Select</option>
<option>CRNA</option>
<option>Anesthesiologist</option>
<option>Dentist</option>
<option>Surgeon</option>
</select>
</label>

<label><input type="checkbox" id="prior"> Reviewed prior to induction</label>

<br><br>
<button onclick="generatePDF()">Generate PDF Report</button>

<script>
function preview(input, img){
const file=input.files[0];
if(!file)return;
const reader=new FileReader();
reader.onload=e=>img.src=e.target.result;
reader.readAsDataURL(file);
}

document.getElementById("airwayImage").onchange=function(){
preview(this,document.getElementById("airwayPreview"));
if(this.files.length)document.getElementById("airwayStatus").textContent="Complete";
document.getElementById("airwayStatus").className="complete";
};

document.querySelectorAll(".imgInput").forEach((input,i)=>{
const img=document.querySelectorAll(".preview")[i+1];
const status=document.querySelectorAll(".status")[i];
input.onchange=function(){
preview(this,img);
status.textContent="Complete";
status.className="status complete";
};
});

function generatePDF(){
const ts=new Date().toLocaleString("en-US",{timeZone:"America/Chicago"});
const pdf=document.createElement("div");
pdf.innerHTML=`
<h1>Pre-Operative Dental & Airway Report</h1>
<strong>Patent Pending · Clinical documentation support tool</strong><br><br>
Session ID: ${document.getElementById("sessionId").value || "Patient Pending"}<br>
Capture Timestamp (CST): ${ts}<br><br>

<h2>Airway Assessment</h2>
Mallampati Class: ${mallampati.value}<br>
Tongue Obstruction: ${tongue.checked?"Yes":"No"}<br><br>

<h3>Observed Findings</h3>
${[...document.querySelectorAll(".obs:checked")].map(o=>o.value).join("<br>")}
`;
html2pdf().set({
margin:10,
filename:"PreOp_Report.pdf",
html2canvas:{scale:2,useCORS:true}
}).from(pdf).save();
}
</script>

</body>
</html>
